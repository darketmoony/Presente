<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Presente Interativo ‚Äî Feito com amor üíå</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;500;700&family=Dancing+Script:wght@400;700&display=swap" rel="stylesheet">

<style>
  :root{
    --bg-a:#fff6fb;
    --bg-b:#eef7ff;
    --accent:#ffb6c1;     
    --accent2:#d8b4ff;    
    --accent3:#cde9ff;    
    --muted:#5b6b7a;
    --card-radius:14px;
    --glass: rgba(255,255,255,0.6);
    --maxw:1100px;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:'Montserrat',system-ui,-apple-system,Segoe UI,Roboto,Arial;
    background: linear-gradient(160deg,var(--bg-a),var(--bg-b));
    color:#192129;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    min-height:100vh;
  }
  .app{max-width:var(--maxw);margin:0 auto;position:relative;padding-bottom:130px;overflow-x:hidden}
  /* top controls */
  .topbar{position:fixed;left:50%;transform:translateX(-50%);top:12px;z-index:1200;display:flex;gap:10px;align-items:center;background:rgba(255,255,255,0.7);padding:8px 12px;border-radius:999px;box-shadow:0 6px 18px rgba(20,30,40,0.06)}
  #contador{font-weight:700;color:var(--muted)}
  .toggle-mode{background:transparent;border:1px solid rgba(0,0,0,0.06);padding:6px 10px;border-radius:10px;cursor:pointer}

  /* stars layer (subtle) */
  #stars, #stars2{position:fixed;inset:0;pointer-events:none;z-index:0}
  #stars{background-image:radial-gradient(circle at 10% 20%, rgba(255,255,255,0.6) 1px, transparent 1px); background-size: 25px 25px; opacity:0.25}
  #stars2{background-image:radial-gradient(circle at 50% 50%, rgba(255,255,255,0.35) 1px, transparent 1px); background-size: 60px 60px; opacity:0.18}

  /* card base */
  .section{padding:84px 20px 40px; min-height:70vh; display:flex;align-items:center;justify-content:center;position:relative;z-index:10}
  .card{width:100%;max-width:900px;background:linear-gradient(180deg,rgba(255,255,255,0.85),rgba(255,255,255,0.95));border-radius:var(--card-radius);padding:26px;box-shadow:0 12px 30px rgba(22,28,36,0.06);text-align:center;border:1px solid rgba(0,0,0,0.04)}

  h1.title{font-family:'Dancing Script',cursive;font-size:34px;margin:6px 0;color:var(--muted)}
  p.lead{color:#495059;margin:8px 0 14px}

  /* menu bottom app style */
  nav.bottom{position:fixed;bottom:18px;left:50%;transform:translateX(-50%);z-index:1400;display:flex;gap:10px;background:rgba(255,255,255,0.85);padding:8px;border-radius:999px;border:1px solid rgba(0,0,0,0.04);backdrop-filter:blur(6px)}
  .tabBtn{padding:10px 12px;border-radius:999px;border:none;background:linear-gradient(90deg,var(--accent),var(--accent2));cursor:pointer;font-weight:700}
  .tabBtn.inactive{opacity:0.55;transform:scale(.98)}
  .tabBtn.active{box-shadow:0 8px 24px rgba(200,150,200,0.12)}

  /* hide/show sections */
  .hidden{display:none}

  /* primary button */
  .btn-primary{padding:12px 18px;border-radius:999px;border:none;background:linear-gradient(90deg,var(--accent2),var(--accent3));cursor:pointer;font-weight:700;box-shadow:0 8px 20px rgba(0,0,0,0.06)}

  /* typing */
  .typing{display:inline-block;white-space:nowrap;overflow:hidden;border-right:3px solid rgba(0,0,0,0.07);font-size:1.05rem;padding-right:6px}

 /* =========================
   GALERIA (polaroids)
   ========================= */
.polaroids {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
  justify-content: center;
  margin-top: 18px;
}

.polaroid {
  background: #fff;
  padding: 10px;
  border-radius: 10px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.08);
  transition: transform .25s;
}

.polaroid img {
  width: 100%;
  height: 320px;       
  object-fit: cover;   
  border-radius: 8px;
  display: block;
}

.polaroid:hover {
  transform: scale(1.03);
}

/* =========================
   CARROSSEL 2D (com corte regul√°vel)
   ========================= */
   .carousel-wrap {
  width: 70%;              
  max-width: 800px;        
  margin: 20px auto;
  overflow: hidden;
  border-radius: 16px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.06);
}

.carousel {
  display: flex;
  transition: transform 0.6s ease-in-out;
}

.card-2d {
  min-width: 100%;
  height: 420px;         /* üî• altura do carrossel (tu pode mudar) */
  border-radius: 16px;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #f8fdfd;
}

/* ==== Ajuste das imagens do carrossel (sem distorcer) ==== */
.card-2d img {
  width: 100%;
  height: 100%;
  object-fit: contain;       /* corta sem distorcer */
  object-position: center; /* foca no centro (pode mudar p/ top se quiser focar no topo) */
  transform: scale(1.5);  /* zoom leve (tu pode regular ou tirar) */
  border-radius: 12px;
}


/* =========================
   CONTROLES
   ========================= */
.carousel-controls {
  display: flex;
  gap: 10px;
  justify-content: center;
  margin-top: 14px;
}

.smallBtn {
  padding: 8px 12px;
  border-radius: 10px;
  border: none;
  background: #fff;
  box-shadow: 0 6px 18px rgba(0,0,0,0.08);
  cursor: pointer;
  transition: background 0.3s;
}

.smallBtn:hover {
  background: #f3f3f3;
}
  
  /* heart buttons for messages */
  .heartGrid{display:flex;gap:12px;flex-wrap:wrap;justify-content:center;margin-top:12px}
  .heartBtn{width:64px;height:64px;border-radius:999px;border:none;background:linear-gradient(180deg,var(--accent),var(--accent3));font-size:24px;display:flex;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 8px 18px rgba(0,0,0,0.06)}
  .heartBtn.pulse{animation:pulse 1.6s infinite}
  @keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.06)}100%{transform:scale(1)}}

  .messageBox{margin-top:12px;min-height:60px;font-size:1.05rem;color:var(--muted)}

  /* coupons raspadinha */
  .coupons{display:flex;flex-wrap:wrap;gap:14px;justify-content:center;margin-top:18px}
  .coupon{width:200px;height:100px;border-radius:12px;position:relative;overflow:hidden;background:linear-gradient(90deg,var(--accent3),var(--accent2));box-shadow:0 12px 30px rgba(0,0,0,0.06)}
  .coupon .prize{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:16px;color:#072028;z-index:1;padding:10px;text-align:center}
  .coupon canvas{position:absolute;inset:0;z-index:2;display:block;opacity:1;touch-action:none}
 
  /* confetti particles (CSS) */
  .fx-layer{position:fixed;inset:0;pointer-events:none;z-index:1300}
  .confetti{position:absolute;width:10px;height:10px;border-radius:50%;opacity:0.95;transform:translateY(-10vh);animation:confettiFall linear forwards}
  @keyframes confettiFall{to{transform:translateY(110vh) rotate(360deg);opacity:0}}

  /* mini-game canvas */
  #mazeCanvas{background:linear-gradient(180deg,#ffffff,#fff0f5);border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,0.06)}

  /* timeline */
  .timeline{display:flex;flex-direction:column;gap:10px;align-items:center;margin-top:18px}
  .timeline .entry{background:#fff;padding:12px;border-radius:10px;width:88%;max-width:720px;box-shadow:0 8px 20px rgba(0,0,0,0.04);cursor:pointer}
  .timeline .date{font-weight:700;color:var(--muted)}
  .timeline .desc{color:#4b5563;margin-top:6px}

  /* letter */
  .letter{white-space:pre-wrap;text-align:left;font-size:1rem;color:#21303a;max-width:740px;margin:18px auto}

  /* final */
  .final{margin-top:24px;font-style:italic;color:var(--muted);font-size:1.04rem}

  /* responsiveness */
  @media (max-width:820px){
    .card{padding:18px}
    .carousel{width:240px;height:160px}
    .card-3d{width:240px;height:160px}
    .coupon{width:88%}
  }
</style>
</head>
<body>
  <div id="stars"></div>
  <div id="stars2"></div>

  <div class="app">
    <!-- Topbar -->
    <div class="topbar" role="banner">
      <div id="contador">...</div>
      <button id="toggleMode" class="toggle-mode">Modo ‚òÄÔ∏è/üåô</button>
    </div>

    <!-- Sections (only one visible at a time) -->
    <!-- 1 Cart√£o -->
    <section id="s-cartao" class="section">
      <div class="card">
        <h1 class="title">Para voc√™, amor da minha vida</h1>
        <div class="typing" id="cartaoTyping"></div>
        <div style="margin-top:14px"><img src="imagens/N√ìS-min.png" alt="N√≥s" width="200" style="border-radius:12px;box-shadow:0 12px 30px rgba(0,0,0,0.06)"></div>
        <div style="margin-top:12px"><button id="cartaoSurprise" class="btn-primary">Surpresa</button></div>
        <p class="lead">Toque em "Surpresa" ou deslize para explorar outras abas.</p>
      </div>
    </section>

    <!-- 2 Album -->
    <section id="s-album" class="section hidden">
      <div class="card">
        <h1 class="title" style="font-size:28px">Nosso √Ålbum</h1>
        <div class="carousel-wrap">
          <div class="carousel" id="carousel"></div>
        </div>
        <div class="carousel-controls"><button id="prevPhoto" class="smallBtn">‚óÄ</button><button id="nextPhoto" class="smallBtn">‚ñ∂</button></div>
        <div class="polaroids" id="polaroidArea"></div>
      </div>
    </section>

    <!-- 3 Mensagens Secretas -->
    <section id="s-mensagens" class="section hidden">
      <div class="card">
        <h1 class="title" style="font-size:28px">Mensagens Secretas</h1>
        <p class="lead">Cada cora√ß√£o revela uma mensagem secreta.</p>
        <div class="heartGrid" id="heartGrid"></div>
        <div class="messageBox" id="messageBox"></div>
        <div style="margin-top:10px"><button id="playMsgAudio" class="smallBtn">Ouvir √°udio</button></div>
      </div>
    </section>

    <!-- 4 Cupons raspadinha -->
    <section id="s-cupons" class="section hidden">
      <div class="card">
        <h1 class="title" style="font-size:28px">Cupons Misteriosos</h1>
        <p class="lead">Raspe com o dedo/mouse para revelar. Cada raspadinha libera confete e fogos leves.</p>
        <div class="coupons" id="couponsArea"></div>
      </div>
    </section>

    <!-- 5 Surpresa Aleat√≥ria -->
    <section id="s-surpresa" class="section hidden">
      <div class="card">
        <h1 class="title" style="font-size:28px">Surpresa Aleat√≥ria</h1>
        <p class="lead">Cada vez que abrir, algo novo aparece.</p>
        <div id="surpriseArea" style="min-height:140px;display:flex;align-items:center;justify-content:center"></div>
        <div style="margin-top:12px"><button id="randomSurprise" class="btn-primary">Gerar surpresa</button></div>
      </div>
    </section>

    <!-- 6 Mini-jogo (labirinto) -->
    <section id="s-game" class="section hidden">
      <div class="card">
        <h1 class="title" style="font-size:28px">Mini-jogo do Amor</h1>
        <p class="lead">Leve o ponto at√© o cora√ß√£o. Use o dedo, o mouse ou as setas.</p>
        <canvas id="mazeCanvas" width="520" height="360" style="margin-top:12px"></canvas>
        <div style="margin-top:10px"><button id="resetMaze" class="smallBtn">Reiniciar</button></div>
      </div>
    </section>

    <!-- 7 Quiz do Casal -->
    <section id="s-quiz" class="section hidden">
      <div class="card">
        <h1 class="title" style="font-size:28px">Quiz do Casal</h1>
        <p class="lead">Acerta e ganhe uma surpresa!</p>
        <div id="quizArea" style="margin-top:10px"></div>
      </div>
    </section>

    <!-- 8 Linha do Tempo -->
    <section id="s-timeline" class="section hidden">
      <div class="card">
        <h1 class="title" style="font-size:28px">Nossa Linha do Tempo</h1>
        <div class="timeline" id="timelineArea"></div>
      </div>
    </section>

    <!-- 9 Carta Escondida -->
    <section id="s-letter" class="section hidden">
      <div class="card">
        <h1 class="title" style="font-size:28px">Carta para voc√™</h1>
        <div class="letter" id="letterBox"></div>
        <div style="margin-top:12px"><button id="replayLetter" class="smallBtn">Reescrever</button></div>
      </div>
    </section>

    <!-- 10 Final -->
    <section id="s-final" class="section hidden">
      <div class="card">
        <h1 class="title" style="font-size:28px">Sempre n√≥s</h1>
        <p class="lead">Feito com muito carinho por Emily üíå</p>
        <div class="final">Guarda esse presente, e volta sempre que quiser lembrar do nosso amor.</div>
      </div>
    </section>

    <!-- hidden hearts mini-game container (click to find) -->
    <div id="hiddenHearts" style="position:fixed;inset:0;pointer-events:none;z-index:8"></div>

    <!-- particle layer (confetti / fireworks) -->
    <div class="fx-layer" id="fxLayer"></div>

    <!-- bottom nav -->
    <nav class="bottom" role="navigation">
      <button class="tabBtn active" data-target="s-cartao">üíå</button>
      <button class="tabBtn" data-target="s-album">üì∏</button>
      <button class="tabBtn" data-target="s-mensagens">üíñ</button>
      <button class="tabBtn" data-target="s-cupons">üéüÔ∏è</button>
      <button class="tabBtn" data-target="s-surpresa">üé≤</button>
      <button class="tabBtn" data-target="s-game">üéÆ</button>
      <button class="tabBtn" data-target="s-quiz">‚ùì</button>
      <button class="tabBtn" data-target="s-timeline">üóìÔ∏è</button>
      <button class="tabBtn" data-target="s-letter">‚úâÔ∏è</button>
      <button class="tabBtn" data-target="s-final">‚ú®</button>
    </nav>

  </div>

<script>
/* =========================
   CONFIG
   =========================
*/
const config = {
  startDate: "2024-01-21",
  images: ["imagens/1-min.png","imagens/2-min.png","imagens/3-min.jpg","imagens/4-min.png","imagens/5-min.png","imagens/6-min.png", "imagens/7-min.png","imagens/8-min.png","imagens/9-min.png","imagens/10-min.png",
    "imagens/11-min.png","imagens/12-min.png","imagens/13-min.png","imagens/14-min.png","imagens/15-min.png","imagens/16-min.png","imagens/17-min.png","imagens/18-min.png","imagens/19-min.png","imagens/20-min.png"], 
  albumAudio: "audios/Matheus _ Kauan - Investimento(MP3_160K).mp3",
  messageAudios: ["audios/√Åudio feliz anivers√°rio.mp3"],
  messagesPool: [
    'Voc√™ √© minha alegria di√°ria üíï',
    'Eu te amo mais a cada dia que passaüíñ',
    'Obrigada por existir ‚ú®',
    'Nosso amor √© infinito üíû',
    'Meu lugar favorito √© ao teu lado üåô',
    'Prometo estar contigo nos dias bons e ruins',
    "Eu n√£o sabia o que era felicidade at√© voc√™ aparecer na minha vida.",
    "Em voc√™ encontrei n√£o s√≥ o meu amor, mas tamb√©m a minha paz.",
    "Cada vez que voc√™ diz que me ama, meu cora√ß√£o derrete um pouquinho mais.",
    "Queria poder te dar o mundo, mas tudo o que tenho a oferecer √© meu amor eterno.",
    "Amar voc√™ √© a melhor parte de cada dia.",
    "Com voc√™, a vida √© mais doce, mais leve e infinitamente mais bonita.",
    "Nos seus olhos encontrei o meu lugar favorito no mundo.", 
    "Com voc√™, cada momento √© uma eternidade de felicidade.",
  ],
  couponsPool: [
    'Abra√ßo de 100 minutos ü§ó',
    'Noite de filme + pipoca üçø',
    'Lanche surpresa preparado por mim üçù',
    'Passeio surpresa no s√°bado üåÑ'
  ],
  timeline: [
    {date:"23/12/2023", title:"Come√ßo do nosso amor", text:"O dia em que tudo come√ßou", img:"imagens/linha do tempo (1)-min.png"},
    {date:"17/01/2024", title:"Primeiro encontro", text:"Foi inesquec√≠vel", img:"imagens/linha do tempo (2)-min.png"},
    {date:"20/01/2024", title:"Primeiro baile assumidos", text:"Muita dan√ßa e parenntes olhando", img:"imagens/linha do tempo (3)-min.png"},
    {date:"21/01/2024", title:"Primeiro beijo", text:"Come√ßamos nossa vida a dois", img:"imagens/linha do tempo (4)-min.png"},
    {date:"04/02/2024", title:"Primeiro rodeio juntos", text:"A Vacaria dos Sonhos", img:"imagens/linha do tempo (6)-min.png"},
    {date:"11/02/2024", title:"Primeira foto juntos", text:"Recorda√ß√£o guardada na alma", img:"imagens/linha do tempo (11)-min.png"},
    {date:"20/02/2024", title:"Nossas alian√ßas", text:"Selam compromisso", img:"imagens/linha do tempo (5)-min.png"},
    {date:"14/04/2024", title:"Primeira viagem juntos", text:"Ansiedade e alegria na alma", img:"imagens/linha do tempo (10)-min.png"},
    {date:"14/06/2024", title:"Primeiro dia dos namorados", text:"O dia mais feliz contigo", img:"imagens/linha do tempo (15)-min.png"},
    {date:"13/07/2024", title:"Primeira ida ao cinema", text:"Onde as emo√ß√µes se fizeram presente", img:"imagens/linha do tempo (7)-min.png"},
    {date:"18/08/2024", title:"Fim do jogo", text:"Zeramos It Takes Two", img:"imagens/linha do tempo (12)-min.png"},
    {date:"22/09/2024", title:"Show no Parque", text:"Fomos no show do Bergha", img:"imagens/linha do tempo (19)-min.png"},
    {date:"26/10/2024", title:"Primeiro perrengue juntos", text:"Arrancou risadas do kalzone", img:"imagens/linha do tempo (23)-min.png"},
    {date:"09/12/2024", title:"Ida ao shopping", text:"Com direito a sorteve", img:"imagens/linha do tempo (16)-min.png"},
    {date:"24/12/2024", title:"Primeiro Natal Juntos", text:"Meu maior presente √© voc√™", img:"imagens/linha do tempo (14)-min.png"},
    {date:"30/12/2024", title:"Primeiro Ano Novo Juntos", text:"Meu momento mais feliz", img:"imagens/linha do tempo (22)-min.png"},
    {date:"21/01/2025", title:"Um ano de n√≥s", text:"365 dias mais felizes", img:"imagens/linha do tempo (17)-min.png"},
    {date:"15/02/2025", title:"O baile do meu pai", text:"Dan√ßar com voc√™ √© o que mais amo", img:"imagens/linha do tempo (8)-min.png"},
    {date:"15/06/2025", title:"Segundo dia dos namorados", text:"Muita batata e sorvete", img:"imagens/linha do tempo (9)-min.png"},
    {date:"31/08/2025", title:"Ida a Lagoa- Ciat", text:"Muitas risadas", img:"imagens/linha do tempo (18)-min.png"},
    {date:"20/09/2025", title:"Dia na sorveteria", text:"Sorvete e de combo uma chuva", img:"imagens/linha do tempo (8)-min.png"}, 
    {date:"04/10/2025", title:"Baile dos Monarcas", text:"Um baile que jamais esquecerei", img:"imagens/baile.png"},   
    {date:"07/10/2025", title:"Viagem a Bento", text:"Nossa Primeira viagem sozinhos", img:"imagens/viagem.png"}, 
    {date:"19/10/2025", title:"O grande dia", text:"O anivers√°rio do meu amor", img:"imagens/linha do tempo (20)-min.png"}, 
    {date:"00/00/0000", title:"Futuro", text:"Espa√ßo reservado para nossas proximas aventuras", img:"imagens/linha do tempo-min.png"},    
  ],
  quiz: [
    {q:"Onde foi nosso primeiro encontro?", options:["Rodeio","Centro","Parquinho"], a:1},
    {q:"Qual a comida que mais comemos juntos?", options:["Pizza","Batata frita","Lasanha"], a:0},
    {q:"Em que m√™s come√ßamos a conversar?", options:["Outubro","Setembro","Novembro"], a:0},
    {q:"Qual √© a nossa m√∫sica?", options:["Barranca e fronteira","De Relancina","A primeira vez"], a:2},
    {q:"Quem esquece mais as coisas?", options:["Eu","Voc√™","Os dois"], a:0},
    {q:"Onde foi nosso primeiro beijo?", options:["No rodeio","no parquinho","Na minha casa"], a:2},
    {q:"Qual sobremesa voc√™ acha que √© a minha favorita?", options:["Torta de Lim√£o","Banoffe","Torta de bolacha"], a:1},
    {q:"Qual estilo de m√∫sica que mais gostamos?", options:["Ga√∫cha","funk","Rock"], a:0},
    {q:"Qual roupa eu estava usando no nosso primeiro encontro?", options:["Blusa preta e cal√ß√£o bege","Vestido preto","Blusa bege e cal√ß√£o preto"], a:2},
    {q:"Onde tiramos nossa primeira foto juntos?", options:["Rodeio de Flores","Anivers√°rio da Maria","Rodeio da Vacaria"], a:2},
    {q:"Onde gostar√≠amos de casar?", options:["Igreja","Jardim","Praia"], a:1},
    {q:"Qual foi a primeira viagem juntos?", options:["Flores da Cunha","Espumoso","Monte Alegre dos Campos"], a:0},
  ],
  letterText:
`Meu amor,

Escrever isso me lembra de tudo que vivemos. Nesse tempo juntos, voc√™ me ensinou como ser mais forte, me ensinou que as pessoas s√£o cru√©is e que s√£o poucas que realmente se importam.
Voc√™ me ensinou que o amor vai muito al√©m das palavras e atitudes, amar √© sentir verdadeiramente, se importar com algu√©m de uma forma que a gente nem saiba o por qu√™ comete certas loucuras, amar e conquistar, cada dia mais do que o anterior, √© sonhar junto, √© chorar junto, √© estar junto nos momentos mais dif√≠ceis, mas sem julgar o outro.
√â entender que a gente s√≥ morre uma vez, mas vive todos os dias, e todos os dias √© uma nova chance para se reerguer e fazer algo dar certo.
Amar n√£o √© sobre ser perfeito, mas sim, sempre tentar o m√°ximo pela felicidade do outro, amar n√£o √© sobre dar tudo certo, √© sobre mostrar seu esfor√ßo e que voc√™ pelo menos tentou, amar n√£o √© sobre certo e errado, √© sobre sempre se auxiliar para tentar resolver o problema, amar √© sobre mesmo errando, n√£o desistir. 
E hoje, em seu d√©cimo oitavo anivers√°rio, eu s√≥ vim agradecer por ser essa pessoa incr√≠vel, que me orgulha tanto e me faz ter vontade de viver, a vida nos tr√°s momentos e mem√≥rias que nunca ser√£o apagadas, e voc√™ √© a melhor delas, o meu milagre mais real.
Ent√£o hoje, s√≥ venho aqui te desejar um Feliz Anivers√°rio, que esse dia seja um dos mais felizes da sua vida e tamb√©m agradecer por estar comigo em todos os momentos que eu precisei. 
Eu te amo al√©m das palavras meu Homem.

Com carinho,
Emily üíå`
};

/* =========================
   UTIL & UI NAVIGATION
   ========================= */
const sections = Array.from(document.querySelectorAll('.section'));
const tabs = Array.from(document.querySelectorAll('.tabBtn'));
function showSection(id){
  sections.forEach(s=> s.id === id ? s.classList.remove('hidden') : s.classList.add('hidden'));
  tabs.forEach(t=> t.classList.toggle('active', t.dataset.target === id));
  // confetti subtle on change
  playConfettiSmall();
  // change music
  if(id === 's-cartao') setMusic(config.cartaoAudio);
  else if(id === 's-album') setMusic(config.albumAudio);
  else if(id === 's-cupons') setMusic(config.cuponsAudio);
  else setMusic(config.cartaoAudio);
}
tabs.forEach(t=> t.addEventListener('click', ()=> showSection(t.dataset.target)));

/* touch swipe navigation (simplified) */
let touchStartX=0;
document.addEventListener('touchstart', e => touchStartX = e.changedTouches[0].screenX);
document.addEventListener('touchend', e => {
  const dx = e.changedTouches[0].screenX - touchStartX;
  if(Math.abs(dx) < 60) return;
  const idx = tabs.findIndex(t=> t.classList.contains('active'));
  if(dx < 0) showSection(tabs[Math.min(tabs.length-1, idx+1)].dataset.target);
  else showSection(tabs[Math.max(0, idx-1)].dataset.target);
});

/* contador dias */
function updateCounter(){
  const start = new Date(config.startDate);
  const now = new Date();
  const days = Math.floor((now - start)/(1000*60*60*24));
  document.getElementById('contador').innerText = `Juntos h√° ${days} dias üíï`;
}
updateCounter();

/* toggle mode (just visual change) */
document.getElementById('toggleMode').addEventListener('click', ()=>{
  document.body.classList.toggle('lightmode');
  const on = document.body.classList.contains('lightmode');
  document.getElementById('toggleMode').innerText = on ? 'Noite üåô' : 'Dia ‚òÄÔ∏è';
  // subtle: change bg
  document.body.style.background = on ? 'linear-gradient(160deg,#fff7f9,#f0fbff)' : 'linear-gradient(160deg,var(--bg-a),var(--bg-b))';
});

/* =========================
   MUSIC HANDLER
   ========================= */
let audio = new Audio();
audio.loop = true; audio.volume = 0.45;
function setMusic(src){
  if(!src) return;
  try{
    if(audio.src && audio.src.endsWith(src)) return;
    audio.src = src;
    audio.play().catch(()=>{/* will play on user gesture */});
  }catch(e){}
}
// initial
setMusic(config.cartaoAudio);

/* =========================
   CART√ÉO typing + surprise
   ========================= */
const cartaoTyping = document.getElementById('cartaoTyping');
function typeText(el, text, speed=28){
  el.textContent = '';
  let i = 0;
  const id = setInterval(() => {
    el.textContent += text[i++] || '';
    if(i > text.length) clearInterval(id);
  }, speed);
}

typeText(cartaoTyping, "Cada dia contigo √© minha parte favorita ‚Äî te amo al√©m das palavras. ‚ú®", 28);
document.getElementById('cartaoSurprise').addEventListener('click', ()=> {
  typeText(cartaoTyping, "Surpresa: no s√°bado tem coca + pizza üçï ‚Äî me arruma um sorriso? üíï", 20);
  playConfettiSmall(); fireworkBurst(window.innerWidth/2, window.innerHeight*0.35);
});

/* =========================
   Album: carousel 2D + galeria
   ========================= */
   const carouselEl = document.getElementById('carousel');
const polaroidArea = document.getElementById('polaroidArea');
let carouselIndex = 0;

function buildCarousel(){
  carouselEl.innerHTML = '';
  config.images.forEach((src,i)=>{
    const el = document.createElement('div');
    el.className = 'card-2d';
    const img = document.createElement('img');
    img.src = src; img.alt = `foto ${i+1}`;
    el.appendChild(img);
    carouselEl.appendChild(el);
  });
  updateCarousel();
}

function updateCarousel(){
  const offset = carouselIndex * -100; // cada card ocupa 100% da largura
  carouselEl.style.transform = `translateX(${offset}%)`;
}

document.getElementById('prevPhoto').addEventListener('click', ()=> {
  carouselIndex = (carouselIndex -1 + config.images.length) % config.images.length;
  updateCarousel();
});
document.getElementById('nextPhoto').addEventListener('click', ()=> {
  carouselIndex = (carouselIndex +1) % config.images.length;
  updateCarousel();
});

function buildPolaroids(){
  polaroidArea.innerHTML = '';
  config.images.forEach((src,i)=> {
    const p = document.createElement('div');
    p.className='polaroid';
    p.innerHTML = `<img src="${src}" alt=""><p style="margin:8px 0 0 0;text-align:left">Foto ${i+1}</p>`;
    polaroidArea.appendChild(p);
  });
}

buildCarousel();
buildPolaroids();


/* =========================
   Mensagens secretas (hearts)
   ========================= */
const heartGrid = document.getElementById('heartGrid');
const messageBox = document.getElementById('messageBox');
for(let i=0;i<6;i++){
  const btn = document.createElement('button'); btn.className='heartBtn pulse'; btn.innerText='üíñ';
  btn.addEventListener('click', ()=> revealRandomMessage());
  heartGrid.appendChild(btn);
}
function revealRandomMessage(){
  const pool = config.messagesPool;
  const msg = pool[Math.floor(Math.random()*pool.length)];
  typeMessage(msg);
  playConfettiSmall();
  // play random audio if exists
  if(config.messageAudios.length){
    const idx = Math.floor(Math.random()*config.messageAudios.length);
    new Audio(config.messageAudios[idx]).play().catch(()=>{});
  }
}
function typeMessage(text){
  messageBox.textContent = '';
  let i = 0;
  const speed = 28;
  const id = setInterval(() => {
    messageBox.textContent += text[i++] || '';
    if(i > text.length) clearInterval(id);
  }, speed);
}


/* ===========================
   Cupons raspadinha (canvas overlay)
   =========================== */
   const couponsArea=document.getElementById('couponsArea');
  const fxlayer=document.getElementById('fxLayer');

  function createCoupon(prize){
    const wrap=document.createElement('div');
    wrap.className='coupon';
    const content=document.createElement('div');
    content.className='prize';
    content.textContent=prize;
    wrap.appendChild(content);

    const canvas=document.createElement('canvas');
    canvas.width=200;
    canvas.height=100;
    wrap.appendChild(canvas);

    const ctx=canvas.getContext('2d');
    ctx.fillStyle='#b0b0b0';
    ctx.fillRect(0,0,canvas.width,canvas.height);

    let scratching=false;

    function scratch(x,y){
      ctx.globalCompositeOperation='destination-out';
      ctx.beginPath();
      ctx.arc(x,y,15,0,Math.PI*2);
      ctx.fill();
      ctx.closePath();
    }

    canvas.addEventListener('mousedown',()=>scratching=true);
    canvas.addEventListener('mouseup',()=>{scratching=false;checkScratched();});
    canvas.addEventListener('mousemove',(e)=>{if(scratching){const rect=canvas.getBoundingClientRect();scratch(e.clientX-rect.left,e.clientY-rect.top);}});
    canvas.addEventListener('touchstart',(e)=>{scratching=true;e.preventDefault();});
    canvas.addEventListener('touchend',()=>{scratching=false;checkScratched();});
    canvas.addEventListener('touchmove',(e)=>{if(scratching){const rect=canvas.getBoundingClientRect();const touch=e.touches[0];scratch(touch.clientX-rect.left,touch.clientY-rect.top);}});

    function checkScratched(){
      const pixels=ctx.getImageData(0,0,canvas.width,canvas.height).data;
      let cleared=0;
      for(let i=3;i<pixels.length;i+=4){if(pixels[i]<128) cleared++;}
      if(cleared>pixels.length/8){
        canvas.remove();
        triggerConfetti();
      }
    }

    function triggerConfetti(){
      for(let i=0;i<50;i++){
        const div=document.createElement('div');
        div.className='confetti';
        div.style.background=`hsl(${Math.random()*360},70%,60%)`;
        div.style.left=Math.random()*100+'%';
        div.style.animationDuration=(Math.random()*1+1)+'s';
        fxLayer.appendChild(div);
        setTimeout(()=>fxLayer.removeChild(div),2000);
      }
    }

    couponsArea.appendChild(wrap);
  }

  // Criar cupons
  ['Voc√™ ganhou um dia de filme + comida dele üçù!','Voc√™ ganhou um beijo bem totoso üòò','Cupom surpresa: escolha seu presente üéÅ','Voc√™ ganhou um vale flores üå∏','Um abra√ßo urso ü§ó','Voc√™ ganhou um dia de passeio na sorveteria','Lanche surpresa preparado por mim üçù',
    'Passeio surpresa no s√°bado üåÑ', 'Vale um Piquenique a Dois', 'Vale uma Tarde de Jogos', 'Vale um Spa Completo em Casa', 'Vale uma Tarde de Cozinha a Dois','Vale uma Maratona de Filmes ou S√©ries', 'Vale um "Dia no Passado"'].forEach(c=>createCoupon(c));


// =========================
// Surprise Aleatorio
// =========================
const surpriseArea = document.getElementById('surpriseArea');
const randomSurpriseBtn = document.getElementById('randomSurprise');

function typeText(el, text, speed=28){
  el.textContent = ''; // garante espa√ßos
  let i = 0;
  const id = setInterval(()=>{
    el.textContent += text[i++] || '';
    if(i > text.length) clearInterval(id);
  }, speed);
}

function doRandomSurprise(){
  const r = Math.random();
  surpriseArea.innerHTML = '';

  if(r < 0.33){
    // random message
    const m = config.messagesPool[Math.floor(Math.random()*config.messagesPool.length)];
    const el = document.createElement('div');
    el.style.fontSize = '18px';
    surpriseArea.appendChild(el);
    typeText(el, m, 20); // digita a mensagem com espa√ßos corretos
  } else if(r < 0.66){
    // random photo
    const img = document.createElement('img');
    img.src = config.images[Math.floor(Math.random()*config.images.length)];
    img.style.maxWidth = '80%';
    img.style.borderRadius = '12px';
    img.style.boxShadow = '0 12px 30px rgba(0,0,0,0.06)';
    surpriseArea.appendChild(img);
  } else {
    // small confetti + short text
    const el = document.createElement('div');
    el.style.fontSize = '18px';
    surpriseArea.appendChild(el);
    typeText(el, "Surpresa! Voc√™ merece tudo e mais üíñ", 20);
    playConfettiSmall();
  }
}

// click
randomSurpriseBtn.addEventListener('click', doRandomSurprise);
// run one on load
doRandomSurprise();

/* =========================
   Mini-game maze (simple grid)
   ========================= */
const mazeCanvas = document.getElementById('mazeCanvas');
const mazeCtx = mazeCanvas.getContext('2d');
const mazeCols = 15, mazeRows = 10;
const cellW = mazeCanvas.width / mazeCols, cellH = mazeCanvas.height / mazeRows;
let maze = [];
let player = {x:1,y:1}, goal = {x:13,y:8};
function generateMaze(){
  // simple randomized obstacles (not perfect maze but playable)
  maze = Array.from({length:mazeRows}, ()=> Array.from({length:mazeCols}, ()=> 0));
  // border walls
  for(let r=0;r<mazeRows;r++) for(let c=0;c<mazeCols;c++){
    if(r===0||c===0||r===mazeRows-1||c===mazeCols-1) maze[r][c]=1;
  }
  // random blocks
  for(let i=0;i<mazeRows*mazeCols*0.12;i++){
    const r = Math.floor(Math.random()*(mazeRows-2))+1;
    const c = Math.floor(Math.random()*(mazeCols-2))+1;
    if((r===player.y && c===player.x) || (r===goal.y && c===goal.x)) continue;
    maze[r][c]=1;
  }
  drawMaze();
}
function drawMaze(){
  mazeCtx.clearRect(0,0,mazeCanvas.width,mazeCanvas.height);
  mazeCtx.fillStyle = '#f3f6fb';
  mazeCtx.fillRect(0,0,mazeCanvas.width,mazeCanvas.height);
  // draw cells
  for(let r=0;r<mazeRows;r++) for(let c=0;c<mazeCols;c++){
    if(maze[r][c]===1){ mazeCtx.fillStyle = '#8fa3b6'; mazeCtx.fillRect(c*cellW, r*cellH, cellW, cellH); }
  }
  // draw goal heart
  mazeCtx.fillStyle='rgba(255,120,170,0.95)';
  mazeCtx.font = `${Math.min(cellW,cellH)*0.8}px serif`;
  mazeCtx.textAlign='center'; mazeCtx.textBaseline='middle';
  mazeCtx.fillText('‚ù§', goal.x*cellW + cellW/2, goal.y*cellH + cellH/2);
  // draw player
  mazeCtx.fillStyle='#064e63';
  mazeCtx.beginPath();
  mazeCtx.arc(player.x*cellW + cellW/2, player.y*cellH + cellH/2, Math.min(cellW,cellH)*0.28, 0, Math.PI*2);
  mazeCtx.fill();
}
function tryMove(dx,dy){
  const nx = player.x+dx, ny = player.y+dy;
  if(nx<0 || ny<0 || ny>=mazeRows || nx>=mazeCols) return;
  if(maze[ny][nx]===1) return;
  player.x = nx; player.y = ny; drawMaze();
  if(player.x === goal.x && player.y === goal.y) {
        alert("Voc√™ chegou no meu cora√ß√£o! üíñ");
        typeText(document.getElementById('cartaoTyping'), "Voc√™ chegou ao cora√ß√£o! Surpresa: passeio no domingo üåÖ", 18);
        
    }
    
  }

document.addEventListener('keydown', (e)=> {
  if(document.getElementById('s-game').classList.contains('hidden')) return;
  if(e.key==='ArrowUp') tryMove(0,-1);
  if(e.key==='ArrowDown') tryMove(0,1);
  if(e.key==='ArrowLeft') tryMove(-1,0);
  if(e.key==='ArrowRight') tryMove(1,0);
});
mazeCanvas.addEventListener('touchstart', e=> {
  e.preventDefault();
  // allow drag to move: set start pos
  mazeCanvas._touchStart = {x: e.touches[0].clientX, y: e.touches[0].clientY};
});
mazeCanvas.addEventListener('touchend', e=>{
  const s = mazeCanvas._touchStart; if(!s) return;
  const ex = e.changedTouches[0].clientX, ey = e.changedTouches[0].clientY;
  const dx = ex - s.x, dy = ey - s.y;
  if(Math.abs(dx) > Math.abs(dy)){
    if(dx>30) tryMove(1,0); else if(dx<-30) tryMove(-1,0);
  } else {
    if(dy>30) tryMove(0,1); else if(dy<-30) tryMove(0,-1);
  }
  mazeCanvas._touchStart = null;
});
document.getElementById('resetMaze').addEventListener('click', ()=> { player={x:1,y:1}; generateMaze(); });

generateMaze();

/* =========================
   Quiz
   ========================= */
const quizArea = document.getElementById('quizArea');
let quizIndex=0, quizScore=0;
function renderQuiz(){
  quizArea.innerHTML = '';
  if(quizIndex >= config.quiz.length){
    const res = document.createElement('div'); res.innerHTML = `<p style="font-weight:700">Voc√™ acertou ${quizScore} de ${config.quiz.length}!</p>`;
    quizArea.appendChild(res);
    if(quizScore >= Math.ceil(config.quiz.length/2)) { playConfettiSmall(); fireworkBurst(window.innerWidth/2, window.innerHeight*0.3); typeText(document.getElementById('cartaoTyping'), "Parab√©ns! Voc√™ ganhou um passeio a sua escolha ‚ù§Ô∏è", 22); }
    return;
  }
  const q = config.quiz[quizIndex];
  const qdiv = document.createElement('div'); qdiv.innerHTML = `<p style="font-weight:700">${q.q}</p>`;
  q.options.forEach((opt,i)=> {
    const b = document.createElement('button'); b.className='smallBtn'; b.style.margin='8px'; b.innerText = opt;
    b.addEventListener('click', ()=> {
      if(i===q.a) { quizScore++; b.style.background='#c9f7d6'; } else { b.style.background='#ffd6d6'; }
      quizIndex++; setTimeout(renderQuiz,500);
    });
    qdiv.appendChild(b);
  });
  quizArea.appendChild(qdiv);
}
renderQuiz();

/* =========================
   Timeline
   ========================= */
const timelineArea = document.getElementById('timelineArea');
config.timeline.forEach((t,i)=>{
  const e = document.createElement('div'); e.className='entry';
  e.innerHTML = `<div class="date">${t.date} ‚Äî ${t.title}</div><div class="desc">${t.text}</div>`;
  e.addEventListener('click', ()=> {
    const modal = document.createElement('div');
    modal.style.position='fixed'; modal.style.inset='0'; modal.style.display='flex'; modal.style.alignItems='center'; modal.style.justifyContent='center';
    modal.style.background='rgba(0,0,0,0.4)'; modal.style.zIndex=2000;
    const card = document.createElement('div'); card.style.background='#fff'; card.style.padding='18px'; card.style.borderRadius='12px'; card.style.maxWidth='90%';
    card.innerHTML = `<h3 style="margin:0">${t.title}</h3><p style="color:#334155">${t.text}</p>`;
    if(t.img){ const im = document.createElement('img'); 
    im.src=t.img; 
    im.style.maxWidth='100%'; 
    im.style.maxHeight = '500px';
    im.style.objectFit = 'cover';
    im.style.borderRadius='12px'; 
    card.appendChild(im); }
    const close = document.createElement('button'); 
    close.innerText='Fechar'; close.className='smallBtn'; 
    close.style.marginTop='10px';
    close.addEventListener('click', ()=> modal.remove());
    card.appendChild(close); modal.appendChild(card); 
    document.body.appendChild(modal);
  });
  timelineArea.appendChild(e);
});

/* =========================
   Letter typing
   ========================= */
const letterBox = document.getElementById('letterBox');
function typeLetter(){ letterBox.innerText=''; typeText(letterBox, config.letterText, 22); }
document.getElementById('replayLetter').addEventListener('click', typeLetter);
typeLetter();

/* =========================
   Hidden hearts mini-game (spawn clickable hearts)
   ========================= */
const hiddenHearts = document.getElementById('hiddenHearts');
let heartsToFind = 4, heartsFound = 0;
function spawnHiddenHearts(){
  hiddenHearts.innerHTML='';
  for(let i=0;i<heartsToFind;i++){
    const b = document.createElement('button'); b.style.position='absolute'; b.style.left = (10 + Math.random()*80)+'vw'; b.style.top = (10 + Math.random()*70)+'vh';
    b.style.fontSize = (16 + Math.random()*22)+'px'; b.innerText = 'üíñ'; b.style.border='none'; b.style.background='transparent'; b.style.pointerEvents='auto';
    b.addEventListener('click', ()=> { heartsFound++; b.remove(); if(heartsFound>=heartsToFind){ typeText(document.getElementById('cartaoTyping'), "Voc√™ encontrou todos! Surpresa: passeio surpresa üåÖ", 22); playConfettiSmall(); }});
    hiddenHearts.appendChild(b);
  }
}
setTimeout(spawnHiddenHearts, 1800);

/* =========================
   Particles: confetti small and fireworks
   ========================= */
const fxLayer = document.getElementById('fxLayer');
function playConfettiSmall(){
  for(let i=0;i<18;i++){
    const part = document.createElement('div');
    part.className = 'confetti';
    part.style.left = (10 + Math.random()*80) + 'vw';
    part.style.background = ['#ffd1dc','#e8d7ff','#cde9ff','#fff2cc'][Math.floor(Math.random()*4)];
    part.style.width = (6 + Math.random()*10) + 'px';
    part.style.height = part.style.width;
    fxLayer.appendChild(part);
    const dur = 2400 + Math.random()*1600;
    part.animate([{transform:'translateY(0) rotate(0deg)', opacity:1},{transform:`translateY(${110 + Math.random()*120}vh) rotate(${Math.random()*720}deg)`, opacity:0}], {duration:dur, easing:'cubic-bezier(.2,.8,.2,1)'});
    setTimeout(()=> part.remove(), dur+50);
  }
}
function fireworkBurst(cx, cy){
  for(let i=0;i<18;i++){
    const p = document.createElement('div');
    p.style.position='fixed'; p.style.left = cx + 'px'; p.style.top = cy + 'px'; p.style.zIndex=1600; p.style.pointerEvents='none';
    p.style.fontSize = (10 + Math.random()*22)+'px'; p.innerText = ['‚ú®','üéÜ','üí•'][Math.floor(Math.random()*3)];
    fxLayer.appendChild(p);
    const angle = Math.random()*Math.PI*2; const dist = 40 + Math.random()*120; const dx = Math.cos(angle)*dist, dy = Math.sin(angle)*dist;
    p.animate([{transform:'translate(0,0) scale(1)', opacity:1},{transform:`translate(${dx}px,${dy}px) scale(.4)`, opacity:0}], {duration:700+Math.random()*700, easing:'cubic-bezier(.2,.8,.2,1)'});
    setTimeout(()=>p.remove(), 1400);
  }
}

/* =========================
   PWA / QR / further features could be added later
   ========================= */

/* utils: small startup confetti */
setTimeout(()=> playConfettiSmall(), 900);

/* expose showSection for initial nav active */
showSection('s-cartao');

</script>
</body>
</html>